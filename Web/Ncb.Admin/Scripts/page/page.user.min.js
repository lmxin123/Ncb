+function(n,t){"use strict";n.module("userApp",["ui.bootstrap"]).controller("UserCtrl",function(n,i){var r={userModal:$("#userModal"),userForm:$("#userForm")};n.pageSize=20;n.totalItems=0;n.currentPage=1;n.user={};n.List=[];n.getList=function(){i({url:"/user/getList",method:"POST",headers:{"Content-Type":undefined},transformRequest:function(i){return i=new FormData(t.getElementById("queryForm")),i.append("pageIndex",n.currentPage),i.append("pageSize",n.pageSize),i}}).success(function(t){t.Success?(t.Data.length==0&&common.alert("未查到数据！"),n.List=t.Data,n.totalItems=t.TotalCount):(common.alert(t.Message),n.List=[],n.totalItems=0)}).error(function(){common.alert("出现错误或者网络异常！");n.List=[];n.totalItems=0})};n.operate=function(t,r,u,f,e){var o=$(f.target);if(!o.data("confirm")){o.text("确定要"+e+"吗");o.data("confirm",!0).css({color:"red"});return}common.alert("正在"+e+"...",function(){i.post("/user/"+t,{id:r,state:u}).success(function(t){t.Success?(common.alert(e+"成功！"),n.getList()):(common.alert(t.Message),o.text(e),o.data("confirm",!1).css({color:""}))}).error(function(){common.alert("出现错误或者网络异常！")})})};n.userModal=function(t){if(t){for(var i=0;i<n.List.length;i++)if(n.List[i].Id===t){n.user.Id=n.List[i].Id;n.user.RoleId=n.List[i].RoleId;n.user.UserName=n.List[i].UserName;n.user.Password=n.List[i].Password;n.user.PhoneNumber=n.List[i].PhoneNumber;n.user.Email=n.List[i].Email;n.user.Remark=n.List[i].Remark;r.userModal.find("#Id").val(n.user.Id);r.userModal.find("#RoleId").val(n.user.RoleId);break}}else n.user={};r.userModal.modal("show")};$("#btnCreate").ajaxClick({formSelector:"#userForm",onBefore:function(t){t.$form.attr("action","/user/"+(n.user.Id?"update":"create"))},onCompleted:function(t,i){t.Success?(n.getList(),common.alert("保存成功"),r.userModal.modal("hide")):common.setValErrorMsg(i.$form,"UserName",t.Message);i.reset()}});r.userModal.on("hide.bs.modal",function(){n.user={}});n.getList()}).filter("userStateFilter",function(){return function(n){switch(n){case 0:return"正常";case 1:return"锁定";default:return"删除"}}})}(window.angular,document);