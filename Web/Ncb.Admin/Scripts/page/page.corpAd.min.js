(function(n){"use strict";n.module("adApp",["ui.bootstrap"]).controller("AdCtrl",function(n,t){var i,r,u;n.pageSize=20;n.totalItems=0;n.currentPage=1;n.List=[];n.DetailList=[];n.merchantId="";n.getList=function(i){t({method:"POST",url:"/corpAd/GetList",headers:{"Content-Type":undefined},transformRequest:function(t){return t=new FormData(common.get("queryForm")),t.append("pageIndex",n.currentPage),t.append("pageSize",n.pageSize),t}}).success(function(t){t.Success?(t.Data.length===0&&i&&common.alert("未查到数据！"),n.List=t.Data,n.totalItems=t.TotalCount,r(t.TotalCount)):common.alert(t.Message||"获取数据失败！");setTimeout(function(){$("[data-toggle='popover']").popover({html:!0,delay:{hide:200}})},10)}).error(function(){common.alert("出现错误或者网络异常！");n.totalItems=0})};n.getDetailList=function(r){t.post("/corpAd/getDetailList",{adID:r}).success(function(t){t.Success?(n.DetailList=t.Data,i.detailModel.modal("show")):common.alert(t.Message||"获取数据失败！")}).error(function(){common.alert("出现错误或者网络异常！")})};n.delete=function(i,r){var u=$(r.target);if(!u.data("delete")){u.text("确定要删除吗");u.data("delete",!0).css({color:"red"});return}common.alert("正在删除...",function(){t.post("/corpAd/delete",{id:i}).success(function(t){t.Success?(common.alert("删除成功！"),n.getList()):(common.alert(t.Message),u.text("删除"),u.data("delete",!1).css({color:""}))}).error(function(){common.alert("出现错误或者网络异常！");n.List=[];n.totalItems=0})})};i={detailModel:$("#detailModal")};r=function(n){$("ul[uib-pagination]").attr("total-items",n).attr("max-size",2)};n.detailModal=function(t){n.getDetailList(t)};i.detailModel.on("hidden.bs.modal",function(){n.detailList=null});u=common.getUrlParameToJSON();u.isCancel&&n.getList()}).filter("areaFilter",function(){return exAreaCode}).filter("playTimeFilter",function(){return function(){var t=arguments[0],n=t.indexOf("，");return n=n===-1?t.indexOf(","):n,n===-1?t:t.substring(0,n)+"..."}});$(function(){})})(window.angular,document);