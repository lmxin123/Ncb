+function(n,t,i){"use strict";var r=function(i,r){var f={loadingCss:"",loadingText:"正在保存...",loadingSize:"18px",loading:"#loading img",formSelector:"form",params:"",url:"",onBefore:null,onCompleted:null},u=this,e=function(i){if(u.ajaxBtn=i,u.spanIcon=u.ajaxBtn.querySelector("i,span"),u.options.defaultHtml=u.ajaxBtn.innerHTML,u.options.loadingCss===""&&(u.options.loadingCss="background: url("+t.querySelector(u.options.loading).src+") no-repeat 0 50%;background-size:"+u.options.loadingSize+";height: "+u.options.loadingSize+";display: inline-block ;padding-left:"+u.options.loadingSize+";"),u.options.formSelector!==""&&(u.$form=n(u.options.formSelector)),typeof jQuery=="function")n(u.ajaxBtn).on("click",common.proxy(u.begin,u));else u.ajaxBtn.addEventListener("tap",common.proxy(u.begin,u))},o=function(n){var t=JSON.parse(n.responseText);if(u.options.onCompleted)u.options.onCompleted(t,u,n);else if(t.Success)u.options.onSuccess(t,u);else u.options.onFaild(t,u)},s=function(n){common.alert(n.Message&&n.Message!=="success"||"保存成功！");u.reset()},h=function(n){common.alert(n.Message||"保存失败，请稍后再试！");u.reset()},c=function(n){common.alert(n.responseText);u.reset()};f.onSuccess=s;f.onFaild=h;f.onErrorde=c;this.begin=function(){var s=this.options.onBefore,t=!1,i,r,f,e,h;if(typeof s=="function"){i=s(u);switch(typeof i){case"boolean":t=i;break;case"object":t=!0;this.options.params=i;break;default:t=!0}}else t=!0;if(t){if(this.$form&&this.$form.length>0&&n.isFunction(this.$form.valid)&&!this.$form.valid())return;if(this.setBusy(),r=new FormData(u.$form[0]),u.options.params)for(f in u.options.params)e=u.options.params[f],typeof e!="function"&&r.append(f,e);h={data:r,type:"POST",contentType:!1,processData:!1,url:u.options.url||u.$form.attr("action"),complete:o,error:u.options.onError};n.ajax(h)}};this.options=n.extend({},f,r);e(i);this.setBusy=function(){var n=document.createElement("span");n.style.cssText=this.options.loadingCss;n.innerText=this.options.loadingText;this.ajaxBtn.classList.add("disabled");this.ajaxBtn.classList.add("mui-disabled");this.ajaxBtn.innerHTML="";this.ajaxBtn.appendChild(n)};this.getLoading=function(){return this.ajaxBtn.children[0]};this.setLoadingText=function(n,t,i){this.getLoading().innerText=n;t&&setTimeout(function(){_selt.reset()},t);i&&(this.getLoading().style.background=null)};this.reset=function(){this.ajaxBtn.classList.remove("disabled");this.ajaxBtn.classList.remove("mui-disabled");this.ajaxBtn.innerHTML=this.options.defaultHtml}};i.AjaxClick=r;n.fn.ajaxClick=function(n){return this.each(function(){var t=this.dataset.ajaxclick,i=typeof n=="object"&&n;return t||(this.dataset.ajaxclick=new r(this,i)),this.dataset.ajaxclick})}}($,document,window);