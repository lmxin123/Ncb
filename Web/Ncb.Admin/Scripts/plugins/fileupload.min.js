+function(n,t,i){"use strict";var r=function(r,u){var f=this,o=1048576,s="{0}文件大小超出要求！上传文件大小不能超过{1} M",e=[],h=function(t){f.$file=n(t);f.container=f.options.container!==""?common.get(f.options.container):f.$file.parent();f.$file.change(function(){f.validate(this.files)})},c=function(n){var i,r,u;return n.size>f.options.imgMaxSize*o?(e.push(String.format(s,n.name,f.options.imgMaxSize)),!1):(i=t.createElement("img"),i.width=100,r=f.$file.attr("multiple"),typeof r!=typeof undefined&&r!==!1?f.container.append(i):(u=f.container.querySelector("img"),u?i=u:f.container.append(i)),f.previewImg(i,n),!0)},l=function(n){return n.size>f.options.vadioMaxSize*o?(e.push(String.format(s,n.name,f.options.vadioMaxSize)),!1):!0};this.options=n.extend({},{imgMaxSize:2,vadioMaxSize:50,maxCount:5,container:"",errorClass:"input-validation-error",imgFilter:/^(image\/bmp|image\/gif|image\/jpeg|image\/png|image\/tiff)$/i,videoFilter:/^(video\/mpvg|video\/mpg|video\/avi|video\/wmv|video\/flv|video\/mp4)$/i,callback:null},u);h(r);this.validate=function(n){var t,i;if(e=[],n.length>this.options.maxCount)e.push("上传文件数量超出限制！");else for(t=0;t<n.length;t++)i=n[t],this.options.imgFilter.test(i.type)?c(i)||(n[t].value=null):this.options.videoFilter.test(i.type)?l(i)||(n[t].value=null):(e.push(i.name+"文件格式不支持上传！"),f.$file[t],n[t].value=null);this.getValidResult()||(common.alert(this.getValidMsg(),5e3),f.$file.addClass(this.options.errorClass))};this.previewImg=function(n,r,u){var e,f;i.navigator.userAgent.indexOf("MSIE")>=1?(n.select(),e=t.selection.createRange().text,n.removeAttribute("src"),n.setAttribute("src",n.value),n.style.filter="progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+e+"', sizingMethod='scale');",u&&typeof u=="function"&&u(n.value)):(f=new FileReader,f.onload=function(t){n.setAttribute("src",t.target.result);u&&typeof u=="function"&&u(t.target.result)},f.readAsDataURL(r))};this.getValidResult=function(){return e.length===0};this.getValidMsg=function(){return e.join("<br>")}};n.fn.file=function(n,t){return this.each(function(){var u=this.dataset.file,f=typeof n=="object"&&n,i;return u||(i=new r(this,f),this.dataset.file=i,t&&t(i)),this.dataset.file})}}($,document,window);